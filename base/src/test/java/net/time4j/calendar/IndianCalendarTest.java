package net.time4j.calendar;

import net.time4j.PlainDate;
import net.time4j.engine.CalendarSystem;
import net.time4j.engine.EpochDays;
import net.time4j.format.expert.Iso8601Format;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.junit.runners.Parameterized;

import java.text.ParseException;
import java.util.Arrays;

import static org.hamcrest.CoreMatchers.is;
import static org.hamcrest.MatcherAssert.assertThat;


@RunWith(Parameterized.class)
public class IndianCalendarTest {

    @Parameterized.Parameters(name= "{index}: indian({0}-{1}-{2})={3} (leap:{4})")
    public static Iterable<Object[]> data() {
        return Arrays.asList(
            new Object[][] {
                {1, 1, 1, "0079-03-22", false},
                {1918, 8, 1, "1996-10-23", true},
                {1937, 10, 10, "2015-12-31", false},
                {1937, 10, 11, "2016-01-01", false},
                {1937, 10, 12, "2016-01-02", false},
                {1937, 10, 13, "2016-01-03", false},
                {1937, 10, 14, "2016-01-04", false},
                {1937, 10, 15, "2016-01-05", false},
                {1937, 10, 16, "2016-01-06", false},
                {1937, 10, 17, "2016-01-07", false},
                {1937, 10, 18, "2016-01-08", false},
                {1937, 10, 19, "2016-01-09", false},
                {1937, 10, 20, "2016-01-10", false},
                {1937, 10, 21, "2016-01-11", false},
                {1937, 10, 22, "2016-01-12", false},
                {1937, 10, 23, "2016-01-13", false},
                {1937, 10, 24, "2016-01-14", false},
                {1937, 10, 25, "2016-01-15", false},
                {1937, 10, 26, "2016-01-16", false},
                {1937, 10, 27, "2016-01-17", false},
                {1937, 10, 28, "2016-01-18", false},
                {1937, 10, 29, "2016-01-19", false},
                {1937, 10, 30, "2016-01-20", false},
                {1937, 11, 1, "2016-01-21", false},
                {1937, 11, 2, "2016-01-22", false},
                {1937, 11, 3, "2016-01-23", false},
                {1937, 11, 4, "2016-01-24", false},
                {1937, 11, 5, "2016-01-25", false},
                {1937, 11, 6, "2016-01-26", false},
                {1937, 11, 7, "2016-01-27", false},
                {1937, 11, 8, "2016-01-28", false},
                {1937, 11, 9, "2016-01-29", false},
                {1937, 11, 10, "2016-01-30", false},
                {1937, 11, 11, "2016-01-31", false},
                {1937, 11, 12, "2016-02-01", false},
                {1937, 11, 13, "2016-02-02", false},
                {1937, 11, 14, "2016-02-03", false},
                {1937, 11, 15, "2016-02-04", false},
                {1937, 11, 16, "2016-02-05", false},
                {1937, 11, 17, "2016-02-06", false},
                {1937, 11, 18, "2016-02-07", false},
                {1937, 11, 19, "2016-02-08", false},
                {1937, 11, 20, "2016-02-09", false},
                {1937, 11, 21, "2016-02-10", false},
                {1937, 11, 22, "2016-02-11", false},
                {1937, 11, 23, "2016-02-12", false},
                {1937, 11, 24, "2016-02-13", false},
                {1937, 11, 25, "2016-02-14", false},
                {1937, 11, 26, "2016-02-15", false},
                {1937, 11, 27, "2016-02-16", false},
                {1937, 11, 28, "2016-02-17", false},
                {1937, 11, 29, "2016-02-18", false},
                {1937, 11, 30, "2016-02-19", false},
                {1937, 12, 1, "2016-02-20", false},
                {1937, 12, 2, "2016-02-21", false},
                {1937, 12, 3, "2016-02-22", false},
                {1937, 12, 4, "2016-02-23", false},
                {1937, 12, 5, "2016-02-24", false},
                {1937, 12, 6, "2016-02-25", false},
                {1937, 12, 7, "2016-02-26", false},
                {1937, 12, 8, "2016-02-27", false},
                {1937, 12, 9, "2016-02-28", false},
                {1937, 12, 10, "2016-02-29", false},
                {1937, 12, 11, "2016-03-01", false},
                {1937, 12, 12, "2016-03-02", false},
                {1937, 12, 13, "2016-03-03", false},
                {1937, 12, 14, "2016-03-04", false},
                {1937, 12, 15, "2016-03-05", false},
                {1937, 12, 16, "2016-03-06", false},
                {1937, 12, 17, "2016-03-07", false},
                {1937, 12, 18, "2016-03-08", false},
                {1937, 12, 19, "2016-03-09", false},
                {1937, 12, 20, "2016-03-10", false},
                {1937, 12, 21, "2016-03-11", false},
                {1937, 12, 22, "2016-03-12", false},
                {1937, 12, 23, "2016-03-13", false},
                {1937, 12, 24, "2016-03-14", false},
                {1937, 12, 25, "2016-03-15", false},
                {1937, 12, 26, "2016-03-16", false},
                {1937, 12, 27, "2016-03-17", false},
                {1937, 12, 28, "2016-03-18", false},
                {1937, 12, 29, "2016-03-19", false},
                {1937, 12, 30, "2016-03-20", false},
                {1938, 1, 1, "2016-03-21", true},
                {1938, 1, 2, "2016-03-22", true},
                {1938, 1, 3, "2016-03-23", true},
                {1938, 1, 4, "2016-03-24", true},
                {1938, 1, 5, "2016-03-25", true},
                {1938, 1, 6, "2016-03-26", true},
                {1938, 1, 7, "2016-03-27", true},
                {1938, 1, 8, "2016-03-28", true},
                {1938, 1, 9, "2016-03-29", true},
                {1938, 1, 10, "2016-03-30", true},
                {1938, 1, 11, "2016-03-31", true},
                {1938, 1, 12, "2016-04-01", true},
                {1938, 1, 13, "2016-04-02", true},
                {1938, 1, 14, "2016-04-03", true},
                {1938, 1, 15, "2016-04-04", true},
                {1938, 1, 16, "2016-04-05", true},
                {1938, 1, 17, "2016-04-06", true},
                {1938, 1, 18, "2016-04-07", true},
                {1938, 1, 19, "2016-04-08", true},
                {1938, 1, 20, "2016-04-09", true},
                {1938, 1, 21, "2016-04-10", true},
                {1938, 1, 22, "2016-04-11", true},
                {1938, 1, 23, "2016-04-12", true},
                {1938, 1, 24, "2016-04-13", true},
                {1938, 1, 25, "2016-04-14", true},
                {1938, 1, 26, "2016-04-15", true},
                {1938, 1, 27, "2016-04-16", true},
                {1938, 1, 28, "2016-04-17", true},
                {1938, 1, 29, "2016-04-18", true},
                {1938, 1, 30, "2016-04-19", true},
                {1938, 1, 31, "2016-04-20", true},
                {1938, 2, 1, "2016-04-21", true},
                {1938, 2, 2, "2016-04-22", true},
                {1938, 2, 3, "2016-04-23", true},
                {1938, 2, 4, "2016-04-24", true},
                {1938, 2, 5, "2016-04-25", true},
                {1938, 2, 6, "2016-04-26", true},
                {1938, 2, 7, "2016-04-27", true},
                {1938, 2, 8, "2016-04-28", true},
                {1938, 2, 9, "2016-04-29", true},
                {1938, 2, 10, "2016-04-30", true},
                {1938, 2, 11, "2016-05-01", true},
                {1938, 2, 12, "2016-05-02", true},
                {1938, 2, 13, "2016-05-03", true},
                {1938, 2, 14, "2016-05-04", true},
                {1938, 2, 15, "2016-05-05", true},
                {1938, 2, 16, "2016-05-06", true},
                {1938, 2, 17, "2016-05-07", true},
                {1938, 2, 18, "2016-05-08", true},
                {1938, 2, 19, "2016-05-09", true},
                {1938, 2, 20, "2016-05-10", true},
                {1938, 2, 21, "2016-05-11", true},
                {1938, 2, 22, "2016-05-12", true},
                {1938, 2, 23, "2016-05-13", true},
                {1938, 2, 24, "2016-05-14", true},
                {1938, 2, 25, "2016-05-15", true},
                {1938, 2, 26, "2016-05-16", true},
                {1938, 2, 27, "2016-05-17", true},
                {1938, 2, 28, "2016-05-18", true},
                {1938, 2, 29, "2016-05-19", true},
                {1938, 2, 30, "2016-05-20", true},
                {1938, 2, 31, "2016-05-21", true},
                {1938, 3, 1, "2016-05-22", true},
                {1938, 3, 2, "2016-05-23", true},
                {1938, 3, 3, "2016-05-24", true},
                {1938, 3, 4, "2016-05-25", true},
                {1938, 3, 5, "2016-05-26", true},
                {1938, 3, 6, "2016-05-27", true},
                {1938, 3, 7, "2016-05-28", true},
                {1938, 3, 8, "2016-05-29", true},
                {1938, 3, 9, "2016-05-30", true},
                {1938, 3, 10, "2016-05-31", true},
                {1938, 3, 11, "2016-06-01", true},
                {1938, 3, 12, "2016-06-02", true},
                {1938, 3, 13, "2016-06-03", true},
                {1938, 3, 14, "2016-06-04", true},
                {1938, 3, 15, "2016-06-05", true},
                {1938, 3, 16, "2016-06-06", true},
                {1938, 3, 17, "2016-06-07", true},
                {1938, 3, 18, "2016-06-08", true},
                {1938, 3, 19, "2016-06-09", true},
                {1938, 3, 20, "2016-06-10", true},
                {1938, 3, 21, "2016-06-11", true},
                {1938, 3, 22, "2016-06-12", true},
                {1938, 3, 23, "2016-06-13", true},
                {1938, 3, 24, "2016-06-14", true},
                {1938, 3, 25, "2016-06-15", true},
                {1938, 3, 26, "2016-06-16", true},
                {1938, 3, 27, "2016-06-17", true},
                {1938, 3, 28, "2016-06-18", true},
                {1938, 3, 29, "2016-06-19", true},
                {1938, 3, 30, "2016-06-20", true},
                {1938, 3, 31, "2016-06-21", true},
                {1938, 4, 1, "2016-06-22", true},
                {1938, 4, 2, "2016-06-23", true},
                {1938, 4, 3, "2016-06-24", true},
                {1938, 4, 4, "2016-06-25", true},
                {1938, 4, 5, "2016-06-26", true},
                {1938, 4, 6, "2016-06-27", true},
                {1938, 4, 7, "2016-06-28", true},
                {1938, 4, 8, "2016-06-29", true},
                {1938, 4, 9, "2016-06-30", true},
                {1938, 4, 10, "2016-07-01", true},
                {1938, 4, 11, "2016-07-02", true},
                {1938, 4, 12, "2016-07-03", true},
                {1938, 4, 13, "2016-07-04", true},
                {1938, 4, 14, "2016-07-05", true},
                {1938, 4, 15, "2016-07-06", true},
                {1938, 4, 16, "2016-07-07", true},
                {1938, 4, 17, "2016-07-08", true},
                {1938, 4, 18, "2016-07-09", true},
                {1938, 4, 19, "2016-07-10", true},
                {1938, 4, 20, "2016-07-11", true},
                {1938, 4, 21, "2016-07-12", true},
                {1938, 4, 22, "2016-07-13", true},
                {1938, 4, 23, "2016-07-14", true},
                {1938, 4, 24, "2016-07-15", true},
                {1938, 4, 25, "2016-07-16", true},
                {1938, 4, 26, "2016-07-17", true},
                {1938, 4, 27, "2016-07-18", true},
                {1938, 4, 28, "2016-07-19", true},
                {1938, 4, 29, "2016-07-20", true},
                {1938, 4, 30, "2016-07-21", true},
                {1938, 4, 31, "2016-07-22", true},
                {1938, 5, 1, "2016-07-23", true},
                {1938, 5, 2, "2016-07-24", true},
                {1938, 5, 3, "2016-07-25", true},
                {1938, 5, 4, "2016-07-26", true},
                {1938, 5, 5, "2016-07-27", true},
                {1938, 5, 6, "2016-07-28", true},
                {1938, 5, 7, "2016-07-29", true},
                {1938, 5, 8, "2016-07-30", true},
                {1938, 5, 9, "2016-07-31", true},
                {1938, 5, 10, "2016-08-01", true},
                {1938, 5, 11, "2016-08-02", true},
                {1938, 5, 12, "2016-08-03", true},
                {1938, 5, 13, "2016-08-04", true},
                {1938, 5, 14, "2016-08-05", true},
                {1938, 5, 15, "2016-08-06", true},
                {1938, 5, 16, "2016-08-07", true},
                {1938, 5, 17, "2016-08-08", true},
                {1938, 5, 18, "2016-08-09", true},
                {1938, 5, 19, "2016-08-10", true},
                {1938, 5, 20, "2016-08-11", true},
                {1938, 5, 21, "2016-08-12", true},
                {1938, 5, 22, "2016-08-13", true},
                {1938, 5, 23, "2016-08-14", true},
                {1938, 5, 24, "2016-08-15", true},
                {1938, 5, 25, "2016-08-16", true},
                {1938, 5, 26, "2016-08-17", true},
                {1938, 5, 27, "2016-08-18", true},
                {1938, 5, 28, "2016-08-19", true},
                {1938, 5, 29, "2016-08-20", true},
                {1938, 5, 30, "2016-08-21", true},
                {1938, 5, 31, "2016-08-22", true},
                {1938, 6, 1, "2016-08-23", true},
                {1938, 6, 2, "2016-08-24", true},
                {1938, 6, 3, "2016-08-25", true},
                {1938, 6, 4, "2016-08-26", true},
                {1938, 6, 5, "2016-08-27", true},
                {1938, 6, 6, "2016-08-28", true},
                {1938, 6, 7, "2016-08-29", true},
                {1938, 6, 8, "2016-08-30", true},
                {1938, 6, 9, "2016-08-31", true},
                {1938, 6, 10, "2016-09-01", true},
                {1938, 6, 11, "2016-09-02", true},
                {1938, 6, 12, "2016-09-03", true},
                {1938, 6, 13, "2016-09-04", true},
                {1938, 6, 14, "2016-09-05", true},
                {1938, 6, 15, "2016-09-06", true},
                {1938, 6, 16, "2016-09-07", true},
                {1938, 6, 17, "2016-09-08", true},
                {1938, 6, 18, "2016-09-09", true},
                {1938, 6, 19, "2016-09-10", true},
                {1938, 6, 20, "2016-09-11", true},
                {1938, 6, 21, "2016-09-12", true},
                {1938, 6, 22, "2016-09-13", true},
                {1938, 6, 23, "2016-09-14", true},
                {1938, 6, 24, "2016-09-15", true},
                {1938, 6, 25, "2016-09-16", true},
                {1938, 6, 26, "2016-09-17", true},
                {1938, 6, 27, "2016-09-18", true},
                {1938, 6, 28, "2016-09-19", true},
                {1938, 6, 29, "2016-09-20", true},
                {1938, 6, 30, "2016-09-21", true},
                {1938, 6, 31, "2016-09-22", true},
                {1938, 7, 1, "2016-09-23", true},
                {1938, 7, 2, "2016-09-24", true},
                {1938, 7, 3, "2016-09-25", true},
                {1938, 7, 4, "2016-09-26", true},
                {1938, 7, 5, "2016-09-27", true},
                {1938, 7, 6, "2016-09-28", true},
                {1938, 7, 7, "2016-09-29", true},
                {1938, 7, 8, "2016-09-30", true},
                {1938, 7, 9, "2016-10-01", true},
                {1938, 7, 10, "2016-10-02", true},
                {1938, 7, 11, "2016-10-03", true},
                {1938, 7, 12, "2016-10-04", true},
                {1938, 7, 13, "2016-10-05", true},
                {1938, 7, 14, "2016-10-06", true},
                {1938, 7, 15, "2016-10-07", true},
                {1938, 7, 16, "2016-10-08", true},
                {1938, 7, 17, "2016-10-09", true},
                {1938, 7, 18, "2016-10-10", true},
                {1938, 7, 19, "2016-10-11", true},
                {1938, 7, 20, "2016-10-12", true},
                {1938, 7, 21, "2016-10-13", true},
                {1938, 7, 22, "2016-10-14", true},
                {1938, 7, 23, "2016-10-15", true},
                {1938, 7, 24, "2016-10-16", true},
                {1938, 7, 25, "2016-10-17", true},
                {1938, 7, 26, "2016-10-18", true},
                {1938, 7, 27, "2016-10-19", true},
                {1938, 7, 28, "2016-10-20", true},
                {1938, 7, 29, "2016-10-21", true},
                {1938, 7, 30, "2016-10-22", true},
                {1938, 8, 1, "2016-10-23", true},
                {1938, 8, 2, "2016-10-24", true},
                {1938, 8, 3, "2016-10-25", true},
                {1938, 8, 4, "2016-10-26", true},
                {1938, 8, 5, "2016-10-27", true},
                {1938, 8, 6, "2016-10-28", true},
                {1938, 8, 7, "2016-10-29", true},
                {1938, 8, 8, "2016-10-30", true},
                {1938, 8, 9, "2016-10-31", true},
                {1938, 8, 10, "2016-11-01", true},
                {1938, 8, 11, "2016-11-02", true},
                {1938, 8, 12, "2016-11-03", true},
                {1938, 8, 13, "2016-11-04", true},
                {1938, 8, 14, "2016-11-05", true},
                {1938, 8, 15, "2016-11-06", true},
                {1938, 8, 16, "2016-11-07", true},
                {1938, 8, 17, "2016-11-08", true},
                {1938, 8, 18, "2016-11-09", true},
                {1938, 8, 19, "2016-11-10", true},
                {1938, 8, 20, "2016-11-11", true},
                {1938, 8, 21, "2016-11-12", true},
                {1938, 8, 22, "2016-11-13", true},
                {1938, 8, 23, "2016-11-14", true},
                {1938, 8, 24, "2016-11-15", true},
                {1938, 8, 25, "2016-11-16", true},
                {1938, 8, 26, "2016-11-17", true},
                {1938, 8, 27, "2016-11-18", true},
                {1938, 8, 28, "2016-11-19", true},
                {1938, 8, 29, "2016-11-20", true},
                {1938, 8, 30, "2016-11-21", true},
                {1938, 9, 1, "2016-11-22", true},
                {1938, 9, 2, "2016-11-23", true},
                {1938, 9, 3, "2016-11-24", true},
                {1938, 9, 4, "2016-11-25", true},
                {1938, 9, 5, "2016-11-26", true},
                {1938, 9, 6, "2016-11-27", true},
                {1938, 9, 7, "2016-11-28", true},
                {1938, 9, 8, "2016-11-29", true},
                {1938, 9, 9, "2016-11-30", true},
                {1938, 9, 10, "2016-12-01", true},
                {1938, 9, 11, "2016-12-02", true},
                {1938, 9, 12, "2016-12-03", true},
                {1938, 9, 13, "2016-12-04", true},
                {1938, 9, 14, "2016-12-05", true},
                {1938, 9, 15, "2016-12-06", true},
                {1938, 9, 16, "2016-12-07", true},
                {1938, 9, 17, "2016-12-08", true},
                {1938, 9, 18, "2016-12-09", true},
                {1938, 9, 19, "2016-12-10", true},
                {1938, 9, 20, "2016-12-11", true},
                {1938, 9, 21, "2016-12-12", true},
                {1938, 9, 22, "2016-12-13", true},
                {1938, 9, 23, "2016-12-14", true},
                {1938, 9, 24, "2016-12-15", true},
                {1938, 9, 25, "2016-12-16", true},
                {1938, 9, 26, "2016-12-17", true},
                {1938, 9, 27, "2016-12-18", true},
                {1938, 9, 28, "2016-12-19", true},
                {1938, 9, 29, "2016-12-20", true},
                {1938, 9, 30, "2016-12-21", true},
                {1938, 10, 1, "2016-12-22", true},
                {1938, 10, 2, "2016-12-23", true},
                {1938, 10, 3, "2016-12-24", true},
                {1938, 10, 4, "2016-12-25", true},
                {1938, 10, 5, "2016-12-26", true},
                {1938, 10, 6, "2016-12-27", true},
                {1938, 10, 7, "2016-12-28", true},
                {1938, 10, 8, "2016-12-29", true},
                {1938, 10, 9, "2016-12-30", true},
                {1938, 10, 10, "2016-12-31", true},
                {1938, 10, 11, "2017-01-01", true},
                {1938, 11, 1, "2017-01-21", true},
                {1938, 12, 1, "2017-02-20", true},
                {1938, 12, 30, "2017-03-21", true},
                {1939, 1, 1, "2017-03-22", false},
                {1939, 2, 1, "2017-04-21", false},
                {999_999_921, 10, 10, "+999999999-12-31", false},
            }
        );
    }

    private static final CalendarSystem<IndianCalendar> CALSYS = IndianCalendar.axis().getCalendarSystem();

    private IndianCalendar indian;
    private long epoch;
    private boolean leap;

    public IndianCalendarTest(
        int year,
        int month,
        int dom,
        String iso,
        boolean leap
    ) throws ParseException {
        super();

        this.indian = IndianCalendar.of(year, month, dom);
        this.epoch = Iso8601Format.EXTENDED_CALENDAR_DATE.parse(iso).get(EpochDays.UTC);
        this.leap = leap;

    }

    @Test
    public void fromIndian() {
        assertThat(
            CALSYS.transform(this.indian),
            is(this.epoch));
    }

    @Test
    public void toIndian() {
        assertThat(
            CALSYS.transform(this.epoch),
            is(this.indian));
    }

    @Test
    public void weekday() {
        assertThat(
            this.indian.getDayOfWeek(),
            is(PlainDate.of(this.epoch, EpochDays.UTC).get(PlainDate.DAY_OF_WEEK)));
    }

    @Test
    public void yearday() {
        assertThat(
            this.indian.getDayOfYear(),
            is(this.indian.get(IndianCalendar.DAY_OF_YEAR).intValue()));
    }

    @Test
    public void isLeapYear() {
        assertThat(
            this.indian.isLeapYear(),
            is(this.leap));
    }

    @Test
    public void unixDays() {
        assertThat(
            this.indian.get(EpochDays.UNIX),
            is(this.epoch + 2 * 365));
    }

}
